import sys
import numpy as np
import sys
sys.path.append("..")
import os
#import pandas as pd
from   skimage import io
from   sklearn.model_selection import train_test_split

from   keras import backend as K
from   keras.preprocessing.image import ImageDataGenerator
from   keras.callbacks import ModelCheckpoint
from   keras.callbacks import ReduceLROnPlateau
import matplotlib.pyplot as plt
from   skimage.external import tifffile as T
from   PIL import Image
#from   model_architecture import *
#########################################################################################
#########################################################################################
#########################################################################################
#########################################################################################
def normalize_one_image(X):


	#nb_dim      = X[0,0,:].size
	min_X       = np.min(X, axis=(0,1))
	max_X       = np.max(X, axis=(0,1))

	d_min_max   = max_X - min_X
	X_minus_min = X - min_X[None,None] 
	X_out       = np.divide(X_minus_min,d_min_max[None,None])



	return X_out

#########################################################################################
#########################################################################################
#########################################################################################
def normalize_stack_whitening_from_trained_data(X, mean_value, mean_std):

	#nb_dim      = X[0,0,:].size

	#mean_X      = np.mean(X, axis=(1,2) , dtype=np.float32)
	#std_X       = np.std (X, axis=(1,2) , dtype=np.float32)

	#mean_mean_X = mean_X.mean()
	#mean_std_X  = std_X.mean() 

	X           = np.subtract(X,mean_value)
	X           = np.divide(X, mean_std)

	return X


#########################################################################################
#########################################################################################
#########################################################################################


#########################################################################################
#########################################################################################
#########################################################################################


#########################################################################################
#########################################################################################
#########################################################################################


#########################################################################################
#########################################################################################
#########################################################################################


#########################################################################################
#########################################################################################
#########################################################################################


#########################################################################################
#########################################################################################
#########################################################################################